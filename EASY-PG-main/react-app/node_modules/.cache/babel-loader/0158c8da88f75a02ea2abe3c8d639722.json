{"ast":null,"code":"import _toConsumableArray from\"C:/xampp/htdocs/EasyPG/EASY-PG-main/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"C:/xampp/htdocs/EasyPG/EASY-PG-main/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/xampp/htdocs/EasyPG/EASY-PG-main/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/xampp/htdocs/EasyPG/EASY-PG-main/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/xampp/htdocs/EasyPG/EASY-PG-main/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import FilterBar from'./FilterBar';import FilterModal from'./FilterModal';import PropertyCard from'./PropertyCard';import NoProperty from'./NoProperty';import{base_path}from'./utils.js';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var pg=/*#__PURE__*/function(_Component){_inherits(pg,_Component);var _super=_createSuper(pg);function pg(){var _this;_classCallCheck(this,pg);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={properties:[],sort:\"none\",filter:{gender:\"none\"}};_this.toggleInterested=function(property_id){fetch(\"\".concat(base_path,\"/api/toggle_interested.php?property_id=\").concat(property_id)).then(function(response){return response.json();}).then(function(responseData){if(responseData.success){console.log('Success');_this.updateInterested(property_id);}else if(!responseData.success&&!responseData.is_logged_in){console.log('Not logged in!');window.$(\"#login-modal\").modal(\"show\");}}).catch(function(error){console.log('Error fetching and parsing data',error);});};_this.updateInterested=function(property_id){var updated_properties=_toConsumableArray(_this.state.properties);updated_properties.forEach(function(property){if(property.id===property_id){property.is_interested=!property.is_interested;if(property.is_interested){property.interested_users_count++;}else{property.interested_users_count--;}}});_this.setState({properties:updated_properties});};_this.updateSort=function(sort){_this.setState({sort:sort});};_this.updateFilter=function(gender){_this.setState({filter:{gender:gender}});};return _this;}_createClass(pg,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var search=window.location.search;//return query string part of url including ?\nvar params=new URLSearchParams(search);//API to convert search query to object\nvar city_name=params.get('city');fetch(\"\".concat(base_path,\"/api/get_properties_by_city.php?city=\").concat(city_name))//API to fetch properties object it returns a promise\n.then(function(response){return response.json();})//response.json() is an api which parse the response to object . it also returns a promise\n.then(function(responseData){_this2.setState({properties:responseData});}).catch(function(error){console.log('Error fetching and parsing data',error);});}},{key:\"render\",value:function render(){var _this3=this;var properties=_toConsumableArray(this.state.properties);// Sorting\nif(this.state.sort!==\"none\"){if(this.state.sort===\"desc\"){properties.sort(function(a,b){return b.rent-a.rent;});}else{properties.sort(function(a,b){return a.rent-b.rent;});}}// Filter\nif(this.state.filter.gender!==\"none\"){properties=properties.filter(function(property){return property.gender===_this3.state.filter.gender;});}var property_cards;if(properties.length>0){property_cards=properties.map(function(property){return/*#__PURE__*/_jsx(PropertyCard,{property:property,toggleInterested:function toggleInterested(){return _this3.toggleInterested(property.id);}},property.id);});}else{property_cards=/*#__PURE__*/_jsx(NoProperty,{});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"page-container\",children:[/*#__PURE__*/_jsx(FilterBar,{currentSort:this.state.sort,updateSort:this.updateSort,currentFilter:this.state.filter}),property_cards]}),/*#__PURE__*/_jsx(FilterModal,{currentFilter:this.state.filter,updateFilter:this.updateFilter})]});}}]);return pg;}(Component);export default pg;","map":{"version":3,"sources":["C:/xampp/htdocs/EasyPG/EASY-PG-main/react-app/src/Pg.js"],"names":["React","Component","FilterBar","FilterModal","PropertyCard","NoProperty","base_path","pg","state","properties","sort","filter","gender","toggleInterested","property_id","fetch","then","response","json","responseData","success","console","log","updateInterested","is_logged_in","window","$","modal","catch","error","updated_properties","forEach","property","id","is_interested","interested_users_count","setState","updateSort","updateFilter","search","location","params","URLSearchParams","city_name","get","a","b","rent","property_cards","length","map"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport FilterBar from './FilterBar';\r\nimport FilterModal from './FilterModal';\r\nimport PropertyCard from './PropertyCard';\r\nimport NoProperty from './NoProperty';\r\nimport { base_path } from './utils.js';\r\n\r\nclass pg extends Component {\r\n\r\n    state = {\r\n        properties: [],\r\n        sort: \"none\",\r\n        filter: {\r\n            gender: \"none\"\r\n        }\r\n    };\r\n\r\n    componentDidMount() {\r\n        const search = window.location.search;//return query string part of url including ?\r\n        const params = new URLSearchParams(search);//API to convert search query to object\r\n        const city_name = params.get('city');\r\n\r\n        fetch(`${base_path}/api/get_properties_by_city.php?city=${city_name}`)//API to fetch properties object it returns a promise\r\n            .then(response => response.json())//response.json() is an api which parse the response to object . it also returns a promise\r\n            .then(responseData => {\r\n                this.setState({\r\n                    properties: responseData\r\n                });\r\n            })\r\n            .catch(error => {\r\n                console.log('Error fetching and parsing data', error);\r\n            });\r\n    }\r\n\r\n    toggleInterested = property_id => {\r\n        fetch(`${base_path}/api/toggle_interested.php?property_id=${property_id}`)\r\n            .then(response => response.json())\r\n            .then(responseData => {\r\n                if (responseData.success) {\r\n                    console.log('Success');\r\n                    this.updateInterested(property_id);\r\n                } else if (!responseData.success && !responseData.is_logged_in) {\r\n                    console.log('Not logged in!');\r\n                    window.$(\"#login-modal\").modal(\"show\");\r\n                }\r\n            })\r\n            .catch(error => {\r\n                console.log('Error fetching and parsing data', error);\r\n            });\r\n    }\r\n\r\n    updateInterested = property_id => {\r\n        let updated_properties = [...this.state.properties];\r\n        updated_properties.forEach((property) => {\r\n            if (property.id === property_id) {\r\n                property.is_interested = !property.is_interested;\r\n                if (property.is_interested) {\r\n                    property.interested_users_count++;\r\n                } else {\r\n                    property.interested_users_count--;\r\n                }\r\n            }\r\n        });\r\n\r\n        this.setState({\r\n            properties: updated_properties\r\n        });\r\n    }\r\n\r\n    updateSort = sort => {\r\n        this.setState({\r\n            sort: sort\r\n        });\r\n    }\r\n\r\n    updateFilter = gender => {\r\n        this.setState({\r\n            filter: {\r\n                gender: gender\r\n            }\r\n        });\r\n    }\r\n\r\n    render() {\r\n        let properties = [...this.state.properties];\r\n\r\n        // Sorting\r\n        if (this.state.sort !== \"none\") {\r\n            if (this.state.sort === \"desc\") {\r\n                properties.sort((a, b) => b.rent - a.rent);\r\n            } else {\r\n                properties.sort((a, b) => a.rent - b.rent);\r\n            }\r\n        }\r\n\r\n        // Filter\r\n        if (this.state.filter.gender !== \"none\") {\r\n            properties = properties.filter(property =>\r\n                property.gender === this.state.filter.gender\r\n            );\r\n        }\r\n\r\n        let property_cards;\r\n        if (properties.length > 0) {\r\n            property_cards = properties.map(property =>\r\n                <PropertyCard\r\n                    key={property.id}\r\n                    property={property}\r\n                    toggleInterested={() => this.toggleInterested(property.id)}\r\n                />\r\n            );\r\n        } else {\r\n            property_cards = <NoProperty />;\r\n        }\r\n\r\n\r\n        return (\r\n            <>\r\n                <div className=\"page-container\">\r\n                    <FilterBar\r\n                        currentSort={this.state.sort}\r\n                        updateSort={this.updateSort}\r\n                        currentFilter={this.state.filter}\r\n                    />\r\n\r\n                    {property_cards}\r\n                </div>\r\n\r\n                <FilterModal\r\n                    currentFilter={this.state.filter}\r\n                    updateFilter={this.updateFilter}\r\n                />\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport default pg;"]},"metadata":{},"sourceType":"module"}
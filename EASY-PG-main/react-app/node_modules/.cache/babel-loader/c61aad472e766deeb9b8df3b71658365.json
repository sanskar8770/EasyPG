{"ast":null,"code":"var _jsxFileName = \"C:\\\\xampp\\\\htdocs\\\\EasyPG\\\\EASY-PG-main\\\\react-app\\\\src\\\\Mess.js\";\nimport React, { Component } from 'react';\nimport FilterBar from './FilterBar';\nimport FilterModal from './FilterModal';\nimport MessCard from './MessCard';\nimport Nomess from './Nomess';\nimport { base_path } from './utils.js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nclass mess extends Component {\n  constructor() {\n    super(...arguments);\n    this.state = {\n      messes: [],\n      sort: \"none\",\n      filter: {\n        gender: \"none\"\n      } // isEditing: false\n\n    };\n\n    this.toggleInterested = mess_id => {\n      fetch(`${base_path}/api/toggle_interested_mess.php?mess_id=${mess_id}`).then(response => response.json()).then(responseData => {\n        if (responseData.success) {\n          console.log('Success');\n          this.updateInterested(mess_id);\n        } else if (!responseData.success && !responseData.is_logged_in) {\n          console.log('Not logged in!');\n          window.$(\"#login-modal\").modal(\"show\");\n        }\n      }).catch(error => {\n        console.log('Error fetching and parsing data', error);\n      });\n    };\n\n    this.updateInterested = mess_id => {\n      let updated_messes = [...this.state.messes];\n      updated_messes.forEach(mess => {\n        if (mess.id === mess_id) {\n          mess.is_interested = !mess.is_interested;\n\n          if (mess.is_interested) {\n            mess.interested_users_count++;\n          } else {\n            mess.interested_users_count--;\n          }\n        }\n      });\n      this.setState({\n        messes: updated_messes\n      });\n    };\n\n    this.updateSort = sort => {\n      this.setState({\n        sort: sort\n      });\n    };\n\n    this.updateFilter = gender => {\n      this.setState({\n        filter: {\n          gender: gender\n        }\n      });\n    };\n  }\n\n  componentDidMount() {\n    const search = window.location.search; //return query string part of url including ?\n\n    const params = new URLSearchParams(search); //API to convert search query to object\n\n    const city_name = params.get('city');\n    fetch(`${base_path}/api/get_messes_by_city.php?city=${city_name}`) //API to fetch messes object it returns a promise\n    .then(response => response.json()) //response.json() is an api which parse the response to object . it also returns a promise\n    .then(responseData => {\n      this.setState({\n        messes: responseData\n      });\n    }).catch(error => {\n      console.log('Error fetching and parsing data', error);\n    });\n  }\n\n  render() {\n    let messes = [...this.state.messes]; // Sorting\n\n    if (this.state.sort !== \"none\") {\n      if (this.state.sort === \"desc\") {\n        messes.sort((a, b) => b.rent - a.rent);\n      } else {\n        messes.sort((a, b) => a.rent - b.rent);\n      }\n    } // Filter\n\n\n    if (this.state.filter.gender !== \"none\") {\n      messes = messes.filter(mess => mess.gender === this.state.filter.gender);\n    }\n\n    let mess_cards;\n\n    if (messes.length > 0) {\n      mess_cards = messes.map(mess => /*#__PURE__*/_jsxDEV(MessCard, {\n        mess: mess // isEditing={this.state.isEditing}\n        ,\n        toggleInterested: () => this.toggleInterested(mess.id)\n      }, mess.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 17\n      }, this));\n    } else {\n      mess_cards = /*#__PURE__*/_jsxDEV(Nomess, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 26\n      }, this);\n    }\n\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"page-container\",\n        children: mess_cards\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 17\n      }, this)\n    }, void 0, false);\n  }\n\n}\n\nexport default mess;","map":{"version":3,"sources":["C:/xampp/htdocs/EasyPG/EASY-PG-main/react-app/src/Mess.js"],"names":["React","Component","FilterBar","FilterModal","MessCard","Nomess","base_path","mess","state","messes","sort","filter","gender","toggleInterested","mess_id","fetch","then","response","json","responseData","success","console","log","updateInterested","is_logged_in","window","$","modal","catch","error","updated_messes","forEach","id","is_interested","interested_users_count","setState","updateSort","updateFilter","componentDidMount","search","location","params","URLSearchParams","city_name","get","render","a","b","rent","mess_cards","length","map"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport FilterBar from './FilterBar';\r\nimport FilterModal from './FilterModal';\r\nimport MessCard from './MessCard';\r\nimport Nomess from './Nomess';\r\nimport { base_path } from './utils.js';\r\n\r\nclass mess extends Component {\r\n\r\n    state = {\r\n        messes: [],\r\n        sort: \"none\",\r\n        filter: {\r\n            gender: \"none\"\r\n        } \r\n       // isEditing: false\r\n    };\r\n    componentDidMount() {\r\n        const search = window.location.search;//return query string part of url including ?\r\n        const params = new URLSearchParams(search);//API to convert search query to object\r\n        const city_name = params.get('city');\r\n\r\n        fetch(`${base_path}/api/get_messes_by_city.php?city=${city_name}`)//API to fetch messes object it returns a promise\r\n            .then(response => response.json())//response.json() is an api which parse the response to object . it also returns a promise\r\n            .then(responseData => {\r\n                this.setState({\r\n                    messes: responseData\r\n                });\r\n            })\r\n            .catch(error => {\r\n                console.log('Error fetching and parsing data', error);\r\n            });\r\n    }\r\n\r\n    toggleInterested = mess_id => {\r\n        fetch(`${base_path}/api/toggle_interested_mess.php?mess_id=${mess_id}`)\r\n            .then(response => response.json())\r\n            .then(responseData => {\r\n                if (responseData.success) {\r\n                    console.log('Success');\r\n                    this.updateInterested(mess_id);\r\n                } else if (!responseData.success && !responseData.is_logged_in) {\r\n                    console.log('Not logged in!');\r\n                    window.$(\"#login-modal\").modal(\"show\");\r\n                }\r\n            })\r\n            .catch(error => {\r\n                console.log('Error fetching and parsing data', error);\r\n            });\r\n    }\r\n\r\n    updateInterested = mess_id => {\r\n        let updated_messes = [...this.state.messes];\r\n        updated_messes.forEach((mess) => {\r\n            if (mess.id === mess_id) {\r\n                mess.is_interested = !mess.is_interested;\r\n                if (mess.is_interested) {\r\n                    mess.interested_users_count++;\r\n                } else {\r\n                    mess.interested_users_count--;\r\n                }\r\n            }\r\n        });\r\n    \r\n\r\n        this.setState({\r\n            messes: updated_messes\r\n        });\r\n    }\r\n\r\n    updateSort = sort => {\r\n        this.setState({\r\n            sort: sort\r\n        });\r\n    }\r\n    // setMenu=menu =>{\r\n    //     this.setState({\r\n    //         menu: menu\r\n    //     });\r\n    // }\r\n    //updateMenu=Event =>\r\n\r\n    updateFilter = gender => {\r\n        this.setState({\r\n            filter: {\r\n                gender: gender\r\n            }\r\n        });\r\n    }\r\n\r\n    render() {\r\n        let messes = [...this.state.messes];\r\n\r\n        // Sorting\r\n        if (this.state.sort !== \"none\") {\r\n            if (this.state.sort === \"desc\") {\r\n                messes.sort((a, b) => b.rent - a.rent);\r\n            } else {\r\n                messes.sort((a, b) => a.rent - b.rent);\r\n            }\r\n        }\r\n\r\n        // Filter\r\n        if (this.state.filter.gender !== \"none\") {\r\n            messes = messes.filter(mess =>\r\n                mess.gender === this.state.filter.gender\r\n            );\r\n        }\r\n\r\n        let mess_cards;\r\n        if (messes.length > 0) {\r\n            mess_cards = messes.map(mess =>\r\n                <MessCard\r\n                    key={mess.id}\r\n                    mess={mess}\r\n                    // isEditing={this.state.isEditing}\r\n                    toggleInterested={() => this.toggleInterested(mess.id)}\r\n                />\r\n            );\r\n        } else {\r\n            mess_cards = <Nomess />;\r\n        }\r\n\r\n\r\n        return (\r\n            <>\r\n                <div className=\"page-container\">\r\n                    {/* <FilterBar\r\n                        currentSort={this.state.sort}\r\n                        updateSort={this.updateSort}\r\n                        currentFilter={this.state.filter}\r\n                    /> */}\r\n\r\n                    {mess_cards}\r\n                </div>\r\n\r\n                {/* <FilterModal\r\n                    currentFilter={this.state.filter}\r\n                    updateFilter={this.updateFilter}\r\n                /> */}\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport default mess;\r\n"]},"metadata":{},"sourceType":"module"}